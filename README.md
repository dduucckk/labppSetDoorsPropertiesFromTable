# labppSetDoorsPropertiesFromTable    

## Установка    

1. Установить себе [`LabPP`](https://www.labpp.ru/labpp-automat-ru);    
2. Активировать лицензию на LabPP, следуя инструкциям самого [`LabPP`](https://www.labpp.ru/labppregru) (лучше попросить админа);    
3. Поставить майкрософт офис (опционально);    
4. Взять актуальный скрипт `labppSetDoorsPropertiesFromTable` руководствуясь следующим пунктом доступ к адону;   

https://user-images.githubusercontent.com/94056361/142477262-8b3ed457-3d18-45f5-b742-8009ada6efc4.mp4



### Доступ к адону    

1. Зарегаться на github.com;    
2. Дать свой никнейм с гитхаба Ивану aka [dduucckk](https://github.com/dduucckk);    
3. Он вас пригласит;    
4. Принять приглашение;    
5. Забрать скрипт последней версии с [дверодела](https://github.com/dduucckk/labppSetDoorsPropertiesFromTable);    
6. Скопировать его в папку с установленным `LabPP` где находятся другие скрипты `C:\Program Files\GRAPHISOFT\ARCHICAD 23\Add-Ons\LabPP_AutomatAC23RUS\tsprglist`;    
7. Переписать `LabPP` из папки `Extras` `LabPP_Automat.apx` в папку с установленным адоном. Можно сразу попросить это сделать админа;    

## Работа через командную строку с git    

1. Поставить себе `git` на компьютер и настроить `git config --global user.name "%USERNAME%"`;    
2. Открыть командную строку `CMD`;    
3. Перейти в папку адона командами `c:`  `cd C:\Program Files\GRAPHISOFT\ARCHICAD 23\Add-Ons\LabPP_AutomatAC23RUS\tsprglist`;    
4. Командой `git clone git@github.com:dduucckk/labppSetDoorsPropertiesFromTable.git ./labppSetDoorsPropertiesFromTable` клонировать в текущую папку;    
5. Командой `cp "labppSetDoorsPropertiesFromTable/Set Doors Properties From Table" ../` копировать содержимое на место;    
6. Для простого обновления репы удалить привязку к оригиналу `git remote remove origin`;    
7. Создать токен как написано тут: [токенодел](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token) скопировать его;     
8. Вставить заместо слова токен свой токен и привязать репу к оригиналу `git remote add origin https://[ТОКЕН]@github.com:dduucckk/labppSetDoorsPropertiesFromTable`;    
9. В дальнейшем чтобы не ходить на сайт можно пользоваться такой строкой из папки с репой (`labppSetDoorsPropertiesFromTable`) `git pull`;    
10. При внесении изменений `git pull` `git add .` `git commit -am ''` `git push`

## Использование    

1.    Открываем `Design-Extras-LabPP`    
![открываем LabPP](images/02.png)    
2.    Открываем set doors properties from file    
![открываем set doors properties from file](images/03.png)    
3.    Нажимаем первую функцию - назначение зон для двери. Каждой двери даём две зоны - входную и выходную. Выделяя на плане (смотри 6 пункт) зону и дверь, нажимаем либо `назначить входную зону` либо `выходную`. Вход всегда осуществляем из лифтового холла, и по направлению от него например жилой коридор это вход, квартира это выход. Лифтовый холл это вход, лестничная клетка - выход.    
![нажимаем иконку-планчик](images/04.png)    
5.    Чтобы посмотреть результат, выделяем двери и нажимаем `Загрузка`, появится список дверей, у которых будет объявлена входная зона и выходная    
![нажимаем загрузку](images/05.png)    
7.    На плане следует выбрать дверь (должна быть редактируемая) и зону. В данном случае, тамбур и выход на улицу, на кровлю. На кровле не всегда есть зона, потому выходная зона будет пустой в данном случае    
![выбор на плане](images/06.png)    

## Правила ассоциации зон и дверей    

1. Двери в Форкамеры не ассоциировать с зонами    
2. Двери шкафов только входная зона    
3. Двери на кровлю ассоциировать с выходной зоной `терраса`    
4. Двери в квартиры ассоциировать с выходными `зонами комнат` (у них единая категория зон) `прихожая` либо `холл`    
5. Двери в лифтовую шахту только входная зона    
6. Если нет зон на этаже - не привязывать двери (шкаф в МТП например. Это может оказаться исключением!)    

## Пошаговая инструкция    

1. скачать с гитхаба    
2. выключить Арчикад    
3. заменить из экстра labpp_automat.apx в папке адона    
4. заменить setdoorspropertiesfromtable в папке tsproglist    
5. открыть файл    
6. чтобы создать пользовательские свойства, привязать одну дверь по инструкции из гитхаба (прямо на странице гитхаба есть с картинками). Выделяешь дверь и зону и жмёшь кнопку    
7. появились свойства дверей OPENINGS и там DOOR_CATEGORY, проставляешь их в соответствии с таблицей LabPP_AutomatAC23INT\tsprglist\Set Doors Properties From Table\src\Характеристики дверей.xls    
8. проставив все типы дверей (в модулях также), импортируешь, в том числе и в модули свойства дверей с заменой из    
X:\070 CAPITAL GROUP\!РАБОЧАЯ ДОКУМЕНТАЦИЯ\070 CAD РД\070 ТАБЛИЦЫ\ОТДЕЛКА\Свойства Дверей.xml    
9. Импортируешь табицы из    
X:\070 CAPITAL GROUP\!РАБОЧАЯ ДОКУМЕНТАЦИЯ\070 CAD РД\070 ТАБЛИЦЫ\ОТДЕЛКА    
РД АР5 ВЕДОМОСТЬ ЗАПОЛНЕНИЯ ДВЕРНЫХ ПРОЁМОВ СВОДНАЯ СОКРАЩЁННАЯ ЭТАЖИ.xml    
РД АР5 ВЕДОМОСТЬ ЗАПОЛНЕНИЯ ДВЕРНЫХ ПРОЁМОВ СВОДНАЯ СОКРАЩЁННАЯ.xml    
10. Меняешь свойства фильтра в таблице (типа этажи, комбинации слоёв и марки и элемент Айди) по аналогии с существующими таблицами по дверям в твоём корпусе, удаляешь и добавляешь фильтрующие условия, так сказать, копируя из старых таблиц.    
11. Маркировку дверей на плане переназначаешь на каждом рабочем листе маркировки с "марки" двери на "тип" двери в категории пользовательских свойств "двери". Можно шприцом, а можно и автопроставлением марок. Заодно обязательно проверить каждую дверь, чтобы всё было правильно.    
12. Если не понятно какой тип на техэтажах применять, смотришь таблицу    
LabPP_AutomatAC23INT\tsprglist\Set Doors Properties From Table\src\Зоны и типы дверей.csv    
Открывается экселем с разделителем ";"    
13. В таблице добавляешь столбик "подтип" и в самой таблице ...СОКРАЩЁННАЯ.xml напротив типа ставишь разные подтипы. Если две строчки абсолютно одинаковые и по размерам и по открыванию и по пожарным характеристикам, то смотри пробелы в типе, бывает что тип проставляется с пробелом в начале.    

## Проблемы    

![ошибка регистрации](images/01.png)    
Решается вызовом админа    
